<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="https://sakula053.github.io/My-DIY-web/HTML/media/favicon.ico">
    <title>Sakula053 的自製遊戲 Demo</title>
    <style>
        
    </style>
    <script>
        var username = prompt("請輸入你想在這使用的使用者名稱。\nPlease enter the username you would like to use here.", "New_user");
        document.write("<h4>Hi, I`m sakula053! Nice to meet ya!<br>You are " + username + ", I learned about it during the process of JavaScript loading prompt data into localStorage.<br>", 
                       "Don't worry, I just wanted to play games on a whim! Nothing strange should happen during the process, even though the game is only a demo version now...<br>"
                       + "<br>嗨！我是櫻花053！很高興認識你！你是 "+ username +" ，我是在 JavaScript 將 prompt 的資料載進 localStorage 的過程中得知的。<br>" +
                      "你放心，我只是心血來潮想做遊戲來玩！應該過程不會發生什麼怪事，儘管遊戲現在只是 Demo 版本...</h4>");
        function write_data()
        {
            localStorage.setItem('username', username);
            console.log('資料已成功寫入 localStorage');
            write_website();
        }
        function write_website()
        {
            var username = localStorage.getItem('username');
            var newContent = "<h4>Hi, " + username + "</h4>";
            document.body.innerHTML = newContent;
        }
    </script>
</head>
<body>
    <br>
    <br>
    <button type="button" onclick="write_data();">測試</button>
    <br>
    <br>
    <button type="button" onclick="save_game();">儲存遊戲</button>
    <br>
    <input type="file" id="file-input" style="display: none;" onchange="handleFile()">
    <button onclick="chooseFile()">選擇遊戲數據文件</button>
    <script>
        function save_game() {
            var gameData = {
                // 這裡是你的遊戲數據
                username: username
                // 其他遊戲數據
            };

            var jsonData = JSON.stringify(gameData);

            // 顯示確認對話框，詢問玩家是否要下載遊戲進度文件
            var confirmDownload = confirm('遊戲進度已保存。是否要下載遊戲進度文件？');
            if (confirmDownload) {
                // 保存遊戲數據
                // 這裡放置保存遊戲數據的動作，例如保存到 localStorage 或者其他地方

                // 下載遊戲進度文件
                var blob = new Blob([jsonData], { type: "application/json" });
                var url = URL.createObjectURL(blob);
                var a = document.createElement('a');
                a.href = url;
                a.download = 'gameData.json';
                a.click();
                URL.revokeObjectURL(url);
                console.log('遊戲進度已成功儲存到 JSON 文件');
            } else {
                console.log('遊戲進度已保存，但未下載遊戲進度文件');
            }
        }
        function chooseFile() {
            var fileInput = document.getElementById('file-input');
            fileInput.click(); // 點擊文件輸入元素，觸發選擇文件操作
        }

        function handleFile() {
            var fileInput = document.getElementById('file-input');
            var file = fileInput.files[0];

            if (file) {
                var reader = new FileReader();

                reader.onload = function(event) {
                    var jsonData = event.target.result;
                    var gameData = JSON.parse(jsonData);
                    // 現在你可以使用這些遊戲數據來恢復遊戲
                    // 例如，設置遊戲中的變量或者更新遊戲界面等
                    console.log('成功恢復遊戲數據:', gameData);
                };

                reader.readAsText(file);
            } else {
                console.log('請選擇一個文件');
            }
        }
    </script>
    </script>
</body>
</html>
